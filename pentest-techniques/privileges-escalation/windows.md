---
description: A list of Privilege Escalation Techniques for Windows.
---

# Windows

## Local Privesc Scanner

### winPEAS

winPEAS is a script that search for possible paths to escalate privileges on **Windows** hosts.&#x20;

> **Github:** [https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS](https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS)

### PrivescCheck

This script aims to enumerate common Windows configuration issues that can be leveraged for local privilege escalation. It also gathers various information that might be useful for exploitation and/or post-exploitation.

> **Github:** [https://github.com/itm4n/PrivescCheck](https://github.com/itm4n/PrivescCheck)

### Windows Exploit Suggester - Next Generation (WES-NG)

**WES-NG** is a tool based on the output of Windows' `systeminfo` utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. Every Windows OS between Windows XP and Windows 11, including their Windows Server counterparts, is supported.

> **Github:** [https://github.com/bitsadmin/wesng](https://github.com/bitsadmin/wesng)

##  Automatic privesc tools

###  PowerUP

PowerUp aims to be a clearinghouse of common Windows privilege escalation vectors that rely on misconfigurations.

Running Invoke-AllChecks will output any identifiable vulnerabilities along with specifications for any abuse functions. The -HTMLReport flag will also generate a COMPUTER.username.html version of the report.

> **Github:** (PowerUP)[https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc]

> ⚠️ This tool is no longer supported

###  Sherlock

PowerShell script to quickly find missing software patches for local privilege escalation vulnerabilities.

> **Github:** (Sherlock)[https://github.com/rasta-mouse/Sherlock]

> ⚠️ This tool is no longer supported

###  Watson

Watson is a .NET tool designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities.

> **Github:** (Watson)[https://github.com/rasta-mouse/Watson]

> ⚠️ This tool is no longer supported

## Impersonation

### JuicyPotatoNG

Allow a Windows Service Accounts to privesc to NT AUTHORITY\SYSTEM when `SeImpersonate` or `SeAssignPrimaryToken` privilege are enabled.

```bash
# Get a shell on the machine
.\JuicyPotatoNG.exe -t * -p "C:\windows\system32\cmd.exe" -i
```

> **Github:** [https://github.com/ohpe/juicy-potato](https://github.com/ohpe/juicy-potato)

##  Harvesting passwords

###  Unattended windows installations

Unattended windows installations require the use of an administrator account to perform the initial setup, which might end up being stored in the machine in the following locations:
```
C:\Unattend.xml
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattend\Unattend.xml
C:\Windows\system32\sysprep.inf
C:\Windows\system32\sysprep\sysprep.xml
```

Credentials could be stored in these files.

###  Powershell history

From cmd:
```cmd
type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

From PowerShell:
```PowerShell
type $Env:userprofile\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

### Windows saved credentials

Use the following command to list the saved credentials:
```PowerShell
cmdkey /list
```

If you see some saved credentials you can run a new shell as this user:
```
runas /savecred /user:privileged_user cmd.exe
```

###  IIS configuration

You might find IIS configuration files in the following locations:
```
C:\inetpub\wwwroot\web.config
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config
```

You can search for "connectionString" to find some database credentials in the config file.
```cmd
type web.config | findstr connectionString
```

###  PuTTY proxy credentials

To retrieve the stored proxy credentials, you can search under the following registry key for ProxyPassword with the following command:
```PowerShell
reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\ /f "Proxy" /s
```

##  Resources

(PayloadsAllTheThings)[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md]
